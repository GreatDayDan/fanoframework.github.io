<!DOCTYPE html>
<!--
Hyperspace by HTML5 UP
html5up.net | @ajlkn
Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
    <title>Using Loggers - Fano Framework</title>
    <meta charset="utf-8" />
    <meta name="description" content="How to use loggers in Fano Framework">
    <meta name="keywords" content="fano, web application, framework, pascal, programming, language, free pascal">
    <meta name="robots" content="index, follow"/>
    <meta property="og:title" content="Using Loggers"/>
    <meta property="og:site_name" content="Fano Framework"/>
    <meta property="og:url" content="http://localhost:4000/utilities/using-loggers/"/>
    <meta property="og:description" content="How to use loggers in Fano Framework"/>
    <meta property="og:type" content="website"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="/assets/css/main.css" />
    <noscript><link rel="stylesheet" href="/assets/css/noscript.css" /></noscript>
</head>
<body class="is-preload">


<!-- Sidebar -->
<section id="sidebar">
    <div class="inner">
        <nav>
            <ul>
                
                    <h3>Getting Started</h3>
                      <ul class="alt">
                        
                          <li><a href="/getting-started">Getting Started</a></li>
                        
                          <li><a href="/tutorials">Step By Step Tutorials</a></li>
                        
                      </ul>
                
                    <h3>Basic</h3>
                      <ul class="alt">
                        
                          <li><a href="/getting-started">Getting Started</a></li>
                        
                      </ul>
                
            </ul>
        </nav>
    </div>
</section>


<!-- Wrapper -->
<div id="wrapper">
    <!-- Main -->
    <section id="main" class="wrapper">
        <div class="inner">
            <h1 class="major">Using Loggers</h1>

<h2 id="logger-and-why-should-you-care">Logger and why should you care?</h2>

<p>There are times when developers need to log something to keep track of things, e.g,
what went wrong (a.k.a error logs), auditing purpose and so on.</p>

<p>Fano Framework provides logging mechanism thorough <code class="highlighter-rouge">ILogger</code> interface. This interface exposes several methods:</p>

<ul>
  <li><code class="highlighter-rouge">log()</code> to log messages in any levels.</li>
  <li><code class="highlighter-rouge">emergency()</code> to log emergency messages.</li>
  <li><code class="highlighter-rouge">critical()</code> to log critical messages.</li>
  <li><code class="highlighter-rouge">error()</code> to log error messages.</li>
  <li><code class="highlighter-rouge">alert()</code> to log alert messages.</li>
  <li><code class="highlighter-rouge">warning()</code> to log warning messages.</li>
  <li><code class="highlighter-rouge">debug()</code> to log debug messages.</li>
  <li><code class="highlighter-rouge">notice()</code> to log notice messages.</li>
  <li><code class="highlighter-rouge">info()</code> to log information messages.</li>
</ul>

<p>Except <code class="highlighter-rouge">log()</code> method, all methods expect two parameter, first parameter is message to log and second parameter is data related to log message. This parameter is optional. If this second parameter is given, then it must implements
<code class="highlighter-rouge">ISerializeable</code> interface.</p>

<ul>
  <li><a href="https://github.com/fanoframework/fano/blob/master/src/Libs/Logger/Contracts/LoggerIntf.pas">See ILogger source code</a> for more information.</li>
  <li><a href="https://github.com/fanoframework/fano/blob/master/src/Core/Contracts/SerializeableIntf.pas">ISerializeable interface</a></li>
</ul>

<p>For example to log critical message,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var logger : ILogger;
...
logger.critical('This is critical message');
</code></pre></div></div>

<h2 id="built-in-logger">Built-in logger</h2>

<p>Fano Framework has several built-in loggers that developers can use or extend.
All built-in loggers inherit from <code class="highlighter-rouge">TAbstractLogger</code> which provides most of method implementations except <code class="highlighter-rouge">log()</code> method which is an abstract method that descendant needs to implements. This class is mostly what developers need to extends in order to create new type of logger.</p>

<h3 id="log-to-system-log">Log to system log</h3>

<p><code class="highlighter-rouge">TSysLogLogger</code> is logger implementation which write log to system log. See <a href="http://man7.org/linux/man-pages/man3/syslog.3.html">syslog(3) man page</a>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var logger : ILogger;
...
logger := TSysLogLogger.create();
</code></pre></div></div>

<p>Its constructor expects three optional parameters.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>constructor TSysLogLogger.create(
    const prefix : string = '';
    const opt : integer = -1;
    const facility : integer = -1
);
</code></pre></div></div>

<ul>
  <li><code class="highlighter-rouge">prefix</code>, string that is prefixed to all log messages,</li>
  <li><code class="highlighter-rouge">opt</code>, integer value for option. If not set, then by default it use <code class="highlighter-rouge">LOG_NOWAIT or LOG_PID</code>.</li>
  <li><code class="highlighter-rouge">facility</code>, integer value for facility. If not set, then by default it use <code class="highlighter-rouge">LOG_USER</code>.</li>
</ul>

<p>See <a href="http://man7.org/linux/man-pages/man3/openlog.3.html">openlog(3) man page</a> for more information.</p>

<h3 id="log-to-file">Log to file</h3>

<p><code class="highlighter-rouge">TFileLogger</code> is logger implementation which write log to file. Its constructor expects filename where to write log. <code class="highlighter-rouge">EInOutError</code> exception will be triggered when
filename can not be created or open for writing. In that case, make sure correct
directory/file permission is given.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var logger : ILogger;
...
logger := TFileLogger.create('storages/logs/app.log');
</code></pre></div></div>

<h3 id="suppress-logging">Suppress logging</h3>

<p><code class="highlighter-rouge">TNullLogger</code> is logger implementation that does nothing. It is provided so developer can disable logging.</p>

<h3 id="logging-to-stdout">Logging to STDOUT</h3>

<p><code class="highlighter-rouge">TStdOutLogger</code> is logger implementation that will output log message to STDOUT.</p>

<h3 id="log-to-several-medium">Log to several medium</h3>

<p><code class="highlighter-rouge">TCompositeLogger</code> is logger implementation that is composed from external <code class="highlighter-rouge">ILogger</code> instances. It can be used to combine two or more loggers as one, thus creating more complex logging functionality. For example, to log to file and to log to RDBMS simultaneously.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var logger : ILogger;
...
logger := TCompositeLogger.create([
    TFileLogger.create('storages/logs/app.log'),
    TSomeLoggerThatLogToDb.create()
]);
</code></pre></div></div>

<h3 id="separate-log-based-on-level-type">Separate log based on level type</h3>

<p>Sometime you may want to separate log based on level. For example, you may want
to log non critical log message to separate file than critical one for easier
audit. Or you need to disable logging  for non critical log message but keep critical log.</p>

<p><code class="highlighter-rouge">TSegregatedLogger</code> is logger implementation which suitable for this kind of logging scenario. This logger expects caller to provide four <code class="highlighter-rouge">ILogger</code> instances
which will handle <code class="highlighter-rouge">INFO</code>, <code class="highlighter-rouge">DEBUG</code>, <code class="highlighter-rouge">WARNING</code> and <code class="highlighter-rouge">CRITICAL</code> log level respectively.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var logger : ILogger;
...
logger := TSegregatedLogger.create(
    TFileLogger.create('storages/logs/app.emergency.log'),
    TFileLogger.create('storages/logs/app.alert.log'),
    TFileLogger.create('storages/logs/app.critical.log'),
    TFileLogger.create('storages/logs/app.error.log'),
    TFileLogger.create('storages/logs/app.warning.log'),
    TFileLogger.create('storages/logs/app.notice.log'),
    TFileLogger.create('storages/logs/app.info.log'),
    TFileLogger.create('storages/logs/app.debug.log')
);
</code></pre></div></div>
<p>This way, each log type is written in separate file, thus make it easier to find,
for example, critical log messages.</p>

<p>Should you need to disable logging <code class="highlighter-rouge">INFO</code> level message, you can replace with something like follows</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var logger : ILogger;
...
logger := TSegregatedLogger.create(
    TFileLogger.create('storages/logs/app.emergency.log'),
    TFileLogger.create('storages/logs/app.alert.log'),
    TFileLogger.create('storages/logs/app.critical.log'),
    TFileLogger.create('storages/logs/app.error.log'),
    TFileLogger.create('storages/logs/app.warning.log'),
    TFileLogger.create('storages/logs/app.notice.log'),
    TNullLogger.create(),
    TFileLogger.create('storages/logs/app.debug.log')
);
</code></pre></div></div>

<p>Or you may want to combine <code class="highlighter-rouge">INFO</code>, <code class="highlighter-rouge">DEBUG</code> into one file and <code class="highlighter-rouge">WARNING</code>, <code class="highlighter-rouge">CRITICAL</code> log message as other file.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var logger, infoDebug, warningCritical : ILogger;
...
infoDebug := TFileLogger.create('storages/logs/app.infodebug.log'),
warningCritical := TFileLogger.create('storages/logs/app.warningcritical.log'),
logger := TSegregatedLogger.create(
    TFileLogger.create('storages/logs/app.emergency.log'),
    TFileLogger.create('storages/logs/app.alert.log'),
    warningCritical,
    TFileLogger.create('storages/logs/app.error.log'),
    warningCritical,
    TFileLogger.create('storages/logs/app.notice.log'),
    infoDebug,
    infoDebug
);
</code></pre></div></div>

<h2 id="factory-class-for-built-in-loggers">Factory class for built-in loggers</h2>

<p>Fano Framework provides some factory class for built-in loggers so they can
be registered in <a href="/dependency-container">dependency container</a> easily. Following factories are available:</p>

<ul>
  <li><code class="highlighter-rouge">TFileLoggerFactory</code>, factory class for <code class="highlighter-rouge">TFileLogger</code>.</li>
  <li><code class="highlighter-rouge">TNullLoggerFactory</code>, factory class for <code class="highlighter-rouge">TNullLogger</code>.</li>
  <li><code class="highlighter-rouge">TCompositeLoggerFactory</code>, factory class for <code class="highlighter-rouge">TCompositeLogger</code>.</li>
  <li><code class="highlighter-rouge">TSegregatedLoggerFactory</code>, factory class for <code class="highlighter-rouge">TSegregatedLogger</code>.</li>
  <li><code class="highlighter-rouge">TStdOutLoggerFactory</code>, factory class for <code class="highlighter-rouge">TStdOutLogger</code>.</li>
  <li><code class="highlighter-rouge">TSysLogLoggerFactory</code>, factory class for <code class="highlighter-rouge">TSysLogLogger</code>.</li>
</ul>

<p>For example, to register <code class="highlighter-rouge">TFileLogger</code> in dependency container:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var container : IDependencyContainer;
...
container.add('logger', TFileLoggerFactory.create('storages/logs/app.log'));
</code></pre></div></div>

<p>To register <code class="highlighter-rouge">TNullLogger</code>,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>container.add('logger', TNullLoggerFactory.create());
</code></pre></div></div>

<p>To register <code class="highlighter-rouge">TCompositeLogger</code>,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>container.add(
    'logger',
    TCompositeLoggerFactory.create(
        TFileLoggerFactory.create('storages/logs/app.log'),
        TNullLoggerFactory.create()
    )
);
</code></pre></div></div>

<p>To register <code class="highlighter-rouge">TSysLogLogger</code>,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>container.add(
    'logger',
    (TSysLogLoggerFactory.create()).prefix('fano-app')
);
</code></pre></div></div>

<p>After logger factory is registered, you can access logger anywhere from application as shown in following code.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var logger : ILogger;
...
logger := container.get('logger) as ILogger;
</code></pre></div></div>

<h2 id="explore-more">Explore more</h2>

<ul>
  <li><a href="/error-handler">Error Handler</a></li>
</ul>

<ul class="actions">
    <li><a href="/documentation" class="button">Documentation</a></li>
</ul>

        </div>
    </section>
</div>


    <!-- Scripts -->
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/jquery.scrollex.min.js"></script>
    <script src="/assets/js/jquery.scrolly.min.js"></script>
    <script src="/assets/js/browser.min.js"></script>
    <script src="/assets/js/breakpoints.min.js"></script>
    <script src="/assets/js/util.js"></script>
    <script src="/assets/js/main.js"></script>

</body>
</html>

