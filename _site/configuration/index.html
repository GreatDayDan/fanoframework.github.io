<!DOCTYPE html>
<!--
Hyperspace by HTML5 UP
html5up.net | @ajlkn
Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
    <title>Application Configuration - Fano Framework</title>
    <meta charset="utf-8" />
    <meta name="description" content="Tutorial on how to work with configuration">
    <meta name="keywords" content="fano, web application, framework, pascal, programming, language, free pascal">
    <meta name="robots" content="index, follow"/>
    <meta property="og:title" content="Application Configuration"/>
    <meta property="og:site_name" content="Fano Framework"/>
    <meta property="og:url" content="http://localhost:4000/configuration/"/>
    <meta property="og:description" content="Tutorial on how to work with configuration"/>
    <meta property="og:type" content="website"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="/assets/css/main.css" />
    <noscript><link rel="stylesheet" href="/assets/css/noscript.css" /></noscript>
</head>
<body class="is-preload">


<!-- Sidebar -->
<section id="sidebar">
    <div class="inner">
        <nav>
            <ul>
                
                    <h3>Getting Started</h3>
                      <ul class="alt">
                        
                          <li><a href="/getting-started">Getting Started</a></li>
                        
                          <li><a href="/tutorials">Step By Step Tutorials</a></li>
                        
                      </ul>
                
                    <h3>Basic</h3>
                      <ul class="alt">
                        
                          <li><a href="/getting-started">Getting Started</a></li>
                        
                      </ul>
                
            </ul>
        </nav>
    </div>
</section>


<!-- Wrapper -->
<div id="wrapper">
    <!-- Main -->
    <section id="main" class="wrapper">
        <div class="inner">
            <h1 class="major">Configuration</h1>

<h2 id="about-configuration">About configuration</h2>

<p>There are times when you need to avoid hard coding value in application because
you need to change it without having to rebuild application binary. For example, you need to be able to store database credential in configuration rather than hard coding, so you can change it easily.</p>

<p>Fano Framework provides <code class="highlighter-rouge">IAppConfiguration</code> interface for that purpose.</p>

<h2 id="iappconfiguration">IAppConfiguration</h2>

<p><code class="highlighter-rouge">IAppConfiguration</code> interface provides two methods</p>

<ul>
  <li><code class="highlighter-rouge">getString()</code> which accepts name and returns string value</li>
  <li><code class="highlighter-rouge">getInt()</code> which accept name returns integer value</li>
  <li><code class="highlighter-rouge">getBool()</code> which accept name returns boolean value</li>
</ul>

<h2 id="built-in-iappconfiguration-implementation">Built-in IAppConfiguration implementation</h2>

<p>Fano Framework provides <code class="highlighter-rouge">TJsonFileConfig</code> and <code class="highlighter-rouge">TIniFileConfig</code> class which loads configuration data from JSON and INI file respectively.</p>

<p>Load config from JSON,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var config : IAppConfiguration;
...
config := TJsonFileConfig.create(
    getCurrentDir() + '/config/config.json'
);
</code></pre></div></div>

<p>Load config from INI,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var config : IAppConfiguration;
...
config := TIniFileConfig.create(
    getCurrentDir() + '/config/config.ini',
    'fano'
);
</code></pre></div></div>
<p>Last parameter is name of default section to use. Read <a href="#ini-file-configuration">INI file configuration</a> section in this document for more information.</p>

<p>To be able to use <code class="highlighter-rouge">TJsonFileConfig</code> and <code class="highlighter-rouge">TIniFileConfig</code> class with <a href="/dependency-container">dependency container</a>, Fano Framework provides <code class="highlighter-rouge">TJsonFileConfigFactory</code> and <code class="highlighter-rouge">TIniFileConfigFactory</code> class which enables you to register above classes in container.</p>

<p>Register JSON config</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>container.add(
    'config',
    TJsonFileConfigFactory.create(
        getCurrentDir() + '/config/config.json'
    )
);
</code></pre></div></div>

<p>Register INI config</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>container.add(
    'config',
    TIniFileConfigFactory.create(
        getCurrentDir() + '/config/config.ini'
    )
);
</code></pre></div></div>

<p>To get configuration instance</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var config : IAppConfiguration;
...
config := container.get('config') as IAppConfiguration;
</code></pre></div></div>

<h2 id="read-configuration-data">Read configuration data</h2>

<p>Suppose you have JSON file with content as follows</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
    "appName" : "MyApp",

    "baseUrl" : "http://myapp.fano",

    "session" : {
        "name" : "fano_sess",
        "dir" : "storages/sessions/"
    },

    "cookie" : {
        "domain" : "myapp.fano",
        "maxAge" : 3600
    }
}
</code></pre></div></div>

<p>To get <code class="highlighter-rouge">baseUrl</code> value,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var baseUrl : string;
...
baseUrl := config.getString('baseUrl');
</code></pre></div></div>

<p>To get <code class="highlighter-rouge">dir</code> value,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var sessionDir : integer;
...
sessionDir := config.getString('session.dir');
</code></pre></div></div>

<p>To get <code class="highlighter-rouge">maxAge</code> value,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var cookieMaxAge : integer;
...
cookieMaxAge := config.getInt('cookie.maxAge');
</code></pre></div></div>

<h2 id="ini-file-configuration"><a name="ini-file-configuration"></a>INI file configuration</h2>

<p><code class="highlighter-rouge">TIniFileConfig</code> is thin wrapper of Free Pascal <code class="highlighter-rouge">TIniFile</code>. <code class="highlighter-rouge">TIniFile</code> cannot read data from INI file that has no section. Your INI file must contain at least one section which serve as default section. The last parameter of <code class="highlighter-rouge">TIniFileConfig</code>â€™s constructor expect name of default section. If you use <code class="highlighter-rouge">TIniFileConfigFactory</code>, by default it uses <code class="highlighter-rouge">fano</code> as default section if not specified. You can specify default section by calling <code class="highlighter-rouge">setDefaultSection()</code> method as shown in following code.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>container.add(
    'config',
    TIniFileConfigFactory.create(
        getCurrentDir() + '/config/config.ini'
    ).setDefaultSection('hello')
);
</code></pre></div></div>

<p>Consider reading <code class="highlighter-rouge">cookie.maxAge</code> configuration in code example above. It will read <code class="highlighter-rouge">maxAge</code> from <code class="highlighter-rouge">cookie</code> section.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[cookie]
maxAge=3600
</code></pre></div></div>

<p>However, because nested section are not allowed in INI file, you can only read on section. For example,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nestedData := config.getInt('fano.data.nested');
</code></pre></div></div>
<p>will read data from</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[fano]
data.nested=test
</code></pre></div></div>

<h2 id="explore-more">Explore more</h2>

<ul>
  <li><a href="/dependency-container">Dependency Container</a></li>
  <li><a href="/working-with-application">Working with Application</a></li>
</ul>

<ul class="actions">
    <li><a href="/documentation" class="button">Documentation</a></li>
</ul>

        </div>
    </section>
</div>


    <!-- Scripts -->
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/jquery.scrollex.min.js"></script>
    <script src="/assets/js/jquery.scrolly.min.js"></script>
    <script src="/assets/js/browser.min.js"></script>
    <script src="/assets/js/breakpoints.min.js"></script>
    <script src="/assets/js/util.js"></script>
    <script src="/assets/js/main.js"></script>

</body>
</html>

